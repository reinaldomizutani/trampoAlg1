-------------------- main.c -----------------------------------

#include "teste.c"

int main(){

// 1 - DECLARAÇÃO DE VARIÁVEIS
    int opcao, erro = 0;
    usuario *usuarios = NULL;// == NULL???????????????????????????????
    livros *acervo = NULL;

// 2 - adicionar usuarios
    char *nome=NULL, *telefone=NULL, *email=NULL;
    int nusp;

    printf("digite a opcao desejada\n");
    scanf("%d", &opcao);

// - PREPARANDO AS LISTAS:

printf("TESTE TESTE");
    criaUsuarios(usuarios);
    criaAcervo(acervo);


while(opcao != -1){

switch(opcao){
    case 1:
        nome = lerstr();
        telefone = lerstr();
        email = lerstr();
        scanf("%d", & nusp);
        cadastraUsuario(usuarios, nome, telefone, email, &nusp, &erro);
        printf("%d", erro);
        //printf("%s\n%s\n%s\n%d\n", nome, telefone, email, nusp);
        break;
}

scanf("%d", &opcao);
}

return 0;
}


-------------------------------- dinamico.h --------------------------------------------
#include<stdio.h>
#include<string.h>
#include<stdlib.h>

////////////////////////////////////////////////////////////////////////////////
// structs
////////////////////////////////////////////////////////////////////////////////


// nó genérico para armazenamento dos usuários da biblioteca
typedef struct bloco{
    char* nome;
    int nusp;
    char* telefone;
    char* email;
    int* livros; // vetor contendo os livros em posse desse usuario
    struct bloco* prox, *ant;
} noUsuarios;

// ponteiros para inicio e fim da lista de usuarios
typedef struct{
    noUsuarios* inicio, *fim;
} usuario;


// nó genérico para armazenamento dos livros no acervo da biblioteca
typedef struct bloco2{
    char *titulo;
    char *autor;
    int isbn;
    char* editora;
    int ano;
    int edicao;
    int qtd;
    struct bloco *prox, *ant;
    int *usuarios; // lista de espera do livro
}noLivro;

// ponteiros para o início e para o fim do catálogo de livros
typedef struct{
    noLivro* inicio, *fim;
} livros;


////////////////////////////////////////////////////////////////////////////////
// funções
////////////////////////////////////////////////////////////////////////////////

char *lerstr();

void cadastraUsuario(usuario *usuarios, char *nome, char *telefone, char *email, int *nusp, int *erro);
void criaUsuarios(usuario *Usuarios);
void criaAcervo(livros *X);


-------------------------------- dinamico.c --------------------------------------------
#include "teste.h"
char *lerstr(){
    int a=0;
    char aux, *vetor=NULL;
    scanf(" %c", &aux);
    while(aux!='\n'){
        vetor = (char*)realloc(vetor, (a+1)*sizeof(char));
        vetor[a]=aux;
        a++;
        aux=getchar();
    }
    vetor[a]='\0';
    return vetor;
}


void cadastraUsuario(usuario *usuarios, char *nome, char *telefone, char *email, int *nusp, int *erro){
    // 1. verifica se não é duplicado
    // 2. cadastra caso não seja duplicado


    noUsuarios *P;
    P = (noUsuarios*)malloc(sizeof(noUsuarios));

    if(P == NULL){
        *erro = 1;
    }
    else{
        *erro = 0;

        if(usuarios->inicio == NULL && usuarios->fim == NULL){
            P->nome = nome;
            P->telefone = telefone;
            P->email = email;
            P->nusp = *nusp;
            P->prox = NULL;
            P->ant = NULL;
            P->livros = NULL;
            usuarios->inicio = P;
            usuarios->fim = P;
        }
        else{
            P->nome = nome;
            P->telefone = telefone;
            P->email = email;
            P->nusp = *nusp;
            P->livros = NULL;
            P->nusp = *nusp;
            P->prox = NULL;
            P->ant = usuarios->fim;
            usuarios->fim->prox = P;

        }
    }
}

void criaUsuarios(usuario *usuarios){

    usuarios->inicio = NULL;
    usuarios->fim = NULL;
}
void criaAcervo(livros *X){
    X->inicio = NULL;
    X->fim = NULL;
}
